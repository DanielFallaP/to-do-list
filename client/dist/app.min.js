function showToast(e,t){Materialize.toast(e,t)}function setInlineEditor(){setTimeout(function(){new MediumEditor(".editable")},0)}function setListAnimation(e,t){e&&setTimeout(function(){showStaggered(e,t)},0)}function setFadeInAnimation(e){e&&setTimeout(function(){Materialize.fadeInImage($(e))},0)}function showStaggered(e,t){var n;if("string"==typeof e)n=$(e);else{if("object"!=typeof e)return;n=e}var o=0;n.find("li").velocity({translateX:t?"-300px":"300px"},{duration:0}),n.find("li").each(function(){$(this).velocity({opacity:"1",translateX:"0"},{duration:800,delay:o,easing:[60,10]}),o+=120})}function readjustPanels(){setTimeout(function(){var e=document.getElementById("leftBucket"),t=document.getElementById("rightBucket");$("#leftBucket").height()>$("#rightBucket").height()?(e.className="col s6 rightDivider",t.className="col s6"):(t.className="col s6 leftDivider",e.className="col s6")},0)}function getTarget(e){return $(document).width()/2>e?"leftBucket":"rightBucket"}var __decorate=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,c=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,n,c):i(t,n))||c);return r>3&&c&&Object.defineProperty(t,n,c),c},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};System.register("to-do",[],function(e,t){"use strict";var n;t&&t.id;return{setters:[],execute:function(){n=function(){function e(){this.deletable=!1,this.editable=!1}return e}(),e("ToDo",n)}}}),System.register("user",[],function(e,t){"use strict";var n;t&&t.id;return{setters:[],execute:function(){n=function(){function e(){}return e}(),e("User",n)}}}),System.register("to-do-list.service",["@angular/core","rxjs/add/operator/toPromise","@angular/http","@angular/router"],function(e,t){"use strict";var n,o,i,r;t&&t.id;return{setters:[function(e){n=e},function(e){},function(e){o=e},function(e){i=e}],execute:function(){r=function(){function e(e,t){this.http=e,this.router=t}return e.prototype.getToDoList=function(e,t){var n=new o.URLSearchParams;n.set("sessionId",this.sessionId);return null!=e&&null!=t&&(n.set("skip",e.toString()),n.set("limit",t.toString())),this.http.get("todos",{search:n}).toPromise().then(function(e){return e.json().data})["catch"](this.handleError)},e.prototype.signIn=function(e){var t=new o.Headers({"Content-Type":"application/json",Accept:"application/json"}),n=new o.RequestOptions({headers:t});return this.loggedInUser={},this.loggedInUser.username=e.username,this.http.post("user/auth",e,n).toPromise()["catch"](this.handleError)},e.prototype.saveToDo=function(e){var t=this,n=new o.URLSearchParams;n.set("sessionId",this.sessionId);var i=new o.Headers({"Content-Type":"application/json",Accept:"application/json"}),r=new o.RequestOptions({headers:i,search:n});return this.http.put("todo",e,r).toPromise().then(function(n){var o=n.json().data;return e.author&&e.author.username||(o.author=t.loggedInUser),o})["catch"](this.handleError)},e.prototype.deleteToDo=function(e){var t=new o.URLSearchParams;t.set("sessionId",this.sessionId);var n=new o.Headers({"Content-Type":"application/json",Accept:"application/json"}),i=new o.RequestOptions({headers:n,search:t,body:e});return this.http["delete"]("todo",i).toPromise().then(function(e){return e.json().data})["catch"](this.handleError)},e.prototype.signOut=function(){var e=new o.URLSearchParams;return e.set("sessionId",this.sessionId),this.http.get("user/logout",{search:e}).toPromise()["catch"](this.handleError)},e.prototype.handleError=function(e){return Promise.reject(e.error||e)},e=__decorate([n.Injectable(),__metadata("design:paramtypes",[o.Http,i.Router])],e)}(),e("ToDoListService",r)}}}),System.register("to-do-list.component",["@angular/core","to-do-list.service","to-do","@angular/router","app/commons.js"],function(e,t){"use strict";var n,o,i,r,c,s,a,u=t&&t.id;return{setters:[function(e){n=e},function(e){o=e},function(e){i=e},function(e){r=e},function(e){}],execute:function(){c="notCompleted",s="completed",a=function(){function e(e,t){this.toDoListService=e,this.router=t}return e.prototype.ngOnInit=function(){var e=this;this.toDoListService.getToDoList(null,null).then(function(t){e.loggedInUser=e.toDoListService.loggedInUser;for(var n in t)t[n].author.username===e.loggedInUser.username?(t[n].deletable=!0,t[n].editable=!0):(t[n].deletable=!1,t[n].editable=!1);e.incomplete=t.filter(function(e){return e.status===c}),e.complete=t.filter(function(e){return e.status===s}),setInlineEditor(),setListAnimation("#incompleteList",!0),setListAnimation("#completeList",!1),setFadeInAnimation("#addButton"),showToast("Welcome back, "+e.loggedInUser.username+"!!",4e3),readjustPanels()})},e.prototype.addToDo=function(){var e=this;this.blankToDo=new i.ToDo,this.blankToDo.title="Enter Title",this.blankToDo.status=c,this.blankToDo.description="Enter Description",this.toDoListService.saveToDo(this.blankToDo).then(function(t){t.editable=!0,t.deletable=!0,e.incomplete.push(t),setFadeInAnimation("#"+t._id+"Card"),showToast("To-Do added!!",4e3),setInlineEditor(),readjustPanels(),setTimeout(function(){window.scrollTo(0,document.getElementById("incompleteList").scrollHeight)},0)})},e.prototype.getCursor=function(e){return e.editable?"text":"move"},e.prototype.saveToDo=function(e){this.savePromise(e).then(function(e){showToast("To-Do saved!!",4e3),readjustPanels()})},e.prototype.savePromise=function(e){var t=document.getElementById(e._id),n=new i.ToDo;return n.status=e.status,e._id&&(n.id=e._id),delete n.deletable,delete n.editable,e.editable&&(n.title=t.querySelector(".title").innerHTML,n.description=t.querySelector(".description").innerHTML),this.toDoListService.saveToDo(n)},e.prototype.deleteToDo=function(e){var t=this,n=new i.ToDo;n.id=e._id,this.toDoListService.deleteToDo(n).then(function(){showToast("To-Do deleted (forever!!)",4e3);var n=document.getElementById(e._id+"Card");n.className+=" scale-out",setTimeout(function(){e.status===c?t.incomplete=t.incomplete.filter(function(t){return t._id!==e._id}):t.complete=t.complete.filter(function(t){return t._id!==e._id}),readjustPanels()},200)})},e.prototype.onDragOver=function(e){e.preventDefault()},e.prototype.onDrag=function(e){this.draggingToDo=e},e.prototype.onDrop=function(e){e.preventDefault();var t=getTarget(e.screenX),n=this.getSource();t!==n&&"rightBucket"===t&&this.moveToComplete(),t!==n&&"leftBucket"===t&&this.moveToIncomplete()},e.prototype.getSource=function(){var e=this,t=this.incomplete.filter(function(t){return e.draggingToDo===t});return 0!=t.length?"leftBucket":"rightBucket"},e.prototype.moveToComplete=function(){var e=this;this.draggingToDo.status=s,this.savePromise(this.draggingToDo).then(function(t){showToast("To-Do completed!!",4e3),e.incomplete=e.incomplete.filter(function(t){return t._id!==e.draggingToDo._id}),e.draggingToDo.title=t.title,e.draggingToDo.description=t.description,e.complete.push(e.draggingToDo),readjustPanels(),setInlineEditor()})},e.prototype.moveToIncomplete=function(){var e=this;this.draggingToDo.status=c,this.savePromise(this.draggingToDo).then(function(t){showToast("To-Do not completed!!",4e3),e.complete=e.complete.filter(function(t){return t._id!==e.draggingToDo._id}),e.draggingToDo.title=t.title,e.draggingToDo.description=t.description,e.incomplete.push(e.draggingToDo),readjustPanels(),setInlineEditor()})},e.prototype.signOut=function(){this.toDoListService.signOut().then(function(){}),this.router.navigate(["/"])},e=__decorate([n.Component({moduleId:u,selector:"to-do-list",templateUrl:"to-do-list.component.html",styleUrls:["to-do-list.component.css"]}),__metadata("design:paramtypes",[o.ToDoListService,r.Router])],e)}(),e("ToDoListComponent",a)}}}),System.register("login.component",["@angular/core","to-do-list.service","user","@angular/http","@angular/router","app/commons.js"],function(e,t){"use strict";var n,o,i,r,c,s,a=t&&t.id;return{setters:[function(e){n=e},function(e){o=e},function(e){i=e},function(e){r=e},function(e){c=e},function(e){}],execute:function(){s=function(){function e(e,t,n,o){this.toDoListService=e,this.http=t,this.router=n,this.ref=o}return e.prototype.ngOnInit=function(){this.user=new i.User,this.user.username="harry",this.user.password="5f4dcc3b5aa765d61d8327deb882cf99",setFadeInAnimation("#loginForm")},e.prototype.signIn=function(e){var t=this;this.toDoListService.signIn(e).then(function(e){if(t.toDoListService.sessionId=e.json().sessionId,e.json().sessionId){t.ref.tick(),t.router.navigate(["/toDoList"])}else showToast("Wrong credentials. Please try again",3e3)})["catch"](this.handleError)},e.prototype.handleError=function(e){showToast("Something went wrong. Please try again later",3e3)},e=__decorate([n.Component({moduleId:a,selector:"login",templateUrl:"login.component.html"}),__metadata("design:paramtypes",[o.ToDoListService,r.Http,c.Router,n.ApplicationRef])],e)}(),e("LoginComponent",s)}}}),System.register("app-routing.module",["@angular/core","@angular/router","to-do-list.component","login.component"],function(e,t){"use strict";var n,o,i,r,c,s;t&&t.id;return{setters:[function(e){n=e},function(e){o=e},function(e){i=e},function(e){r=e}],execute:function(){c=[{path:"toDoList",component:i.ToDoListComponent},{path:"",component:r.LoginComponent}],s=function(){function e(){}return e=__decorate([n.NgModule({imports:[o.RouterModule.forRoot(c)],exports:[o.RouterModule]}),__metadata("design:paramtypes",[])],e)}(),e("AppRoutingModule",s)}}}),System.register("app.component",["@angular/core","to-do-list.service"],function(e,t){"use strict";var n,o,i;t&&t.id;return{setters:[function(e){n=e},function(e){o=e}],execute:function(){i=function(){function e(e){this.toDoListService=e}return e=__decorate([n.Component({selector:"my-app",template:"\n\t<router-outlet></router-outlet>\n  "}),__metadata("design:paramtypes",[o.ToDoListService])],e)}(),e("AppComponent",i)}}}),System.register("app.module",["@angular/core","@angular/platform-browser","@angular/http","app.component","to-do-list.service","to-do-list.component","login.component","app-routing.module","@angular/forms"],function(e,t){"use strict";var n,o,i,r,c,s,a,u,l,d;t&&t.id;return{setters:[function(e){n=e},function(e){o=e},function(e){i=e},function(e){r=e},function(e){c=e},function(e){s=e},function(e){a=e},function(e){u=e},function(e){l=e}],execute:function(){d=function(){function e(){}return e=__decorate([n.NgModule({imports:[o.BrowserModule,i.HttpModule,u.AppRoutingModule,l.FormsModule],declarations:[r.AppComponent,s.ToDoListComponent,a.LoginComponent],providers:[c.ToDoListService],bootstrap:[r.AppComponent]}),__metadata("design:paramtypes",[])],e)}(),e("AppModule",d)}}}),System.register("main",["@angular/platform-browser-dynamic","app.module"],function(e,t){"use strict";var n,o;t&&t.id;return{setters:[function(e){n=e},function(e){o=e}],execute:function(){n.platformBrowserDynamic().bootstrapModule(o.AppModule)}}}),System.register("to-do-list.spec",["to-do-list.service","@angular/router","to-do-list.component","@angular/core/testing","user","to-do","app/mocks/commons-mock.js"],function(e,t){"use strict";var n,o,i,r,c,s,a,u,l,d;t&&t.id;return{setters:[function(e){n=e},function(e){o=e},function(e){i=e},function(e){r=e},function(e){c=e},function(e){s=e},function(e){}],execute:function(){a="notCompleted",u="completed",l=function(){function e(){}return e}(),d=function(){function e(){this.loggedInUser={username:"ali"}}return e.prototype.getToDoList=function(e,t){var n=[],o=new s.ToDo;o._id="1",o.description="",o.title="",o.status=a,o.author={_id:"5757e6e41b0a244b256ac1d6",username:"harry"},n.push(o);var i=new s.ToDo;i._id="2",i.description="",i.title="",i.status=a,i.author={_id:"5757e6e41b0a244b256ac1d5",username:"ali"},n.push(i);var r=new s.ToDo;r._id="3",r.description="",r.title="",r.status=a,r.author={_id:"5757e6e41b0a244b256ac1d6",username:"harry"},n.push(r);var c=new s.ToDo;c._id="4",c.description="",c.title="",c.status=u,c.author={_id:"5757e6e41b0a244b256ac1d5",username:"ali"},n.push(c);var l=new s.ToDo;return l._id="5",l.description="",l.title="",l.status=u,l.author={_id:"5757e6e41b0a244b256ac1d5",username:"ali"},n.push(l),Promise.resolve(n)},e.prototype.saveToDo=function(e){return void 0!=e._id&&null!=e._id||(e._id=(new Date).getTime().toString()),Promise.resolve(e)},e.prototype.deleteToDo=function(e){return Promise.resolve(e)},e}(),describe("Testing ToDo List Component",function(){var e,t;beforeEach(r.async(function(){t=new c.User,t.username="ali",t.password="5f4dcc3b5aa765d61d8327deb882cf99",r.TestBed.configureTestingModule({declarations:[i.ToDoListComponent],providers:[{provide:n.ToDoListService,useClass:d},{provide:o.Router,useClass:l}]}).compileComponents()})),beforeEach(function(){e=r.TestBed.createComponent(i.ToDoListComponent);var t=new c.User;t.username="ali",e.componentInstance.loggedInUser=t,e.detectChanges()}),it("Should load items into complete and incomplete lists correctly",r.async(r.inject([],function(){var t=e.componentInstance;e.whenStable().then(function(){return e.detectChanges(),expect(t.incomplete.length).toBe(3),expect(t.complete.length).toBe(2),e.whenStable()})}))),it("Should load item permissions properly",r.async(r.inject([],function(){var t=e.componentInstance;e.whenStable().then(function(){e.detectChanges();var n=t.incomplete.filter(function(e){return e.editable===!0}).length;n+=t.complete.filter(function(e){return e.editable===!0}).length;var o=t.incomplete.filter(function(e){return e.deletable===!0}).length;return o+=t.complete.filter(function(e){return e.deletable===!0}).length,expect(n).toBe(3),expect(o).toBe(3),e.whenStable()})}))),it("Should get mouse cursor correctly according to permissions",r.async(r.inject([],function(){var t=e.componentInstance;e.whenStable().then(function(){return e.detectChanges(),e.whenStable()}).then(function(){var e=new s.ToDo;e.editable=!0,expect(t.getCursor(e)).toBe("text"),e.editable=!1,expect(t.getCursor(e)).toBe("move")})}))),it("Should save title and description",r.async(r.inject([],function(){var t,n=e.componentInstance;e.whenStable().then(function(){return e.detectChanges(),e.whenStable()}).then(function(){return e.detectChanges(),t=n.incomplete[0],t.editable=!0,t.title="new title",t.description="new description",n.saveToDo(t),e.whenStable()}).then(function(){expect(n.incomplete[0].title).toBe("new title"),t.editable=!1,expect(n.incomplete[0].description).toBe("new description")})}))),it("Should delete items correctly from incomplete list",r.async(r.inject([],function(){var t,n=e.componentInstance;e.whenStable().then(function(){return e.detectChanges(),e.whenStable()}).then(function(){return t=n.incomplete[0],n.deleteToDo(t),e.whenStable()}).then(function(){return e.detectChanges(),e.whenStable()}).then(function(){setTimeout(function(){var e=n.incomplete.filter(function(e){return e===t});expect(n.incomplete.length).toBe(2),expect(e.length).toBe(0)},400)})}))),it("Should delete items correctly from complete list",r.async(r.inject([],function(){var t,n=e.componentInstance;e.whenStable().then(function(){return e.detectChanges(),e.whenStable()}).then(function(){return t=n.complete[0],n.deleteToDo(t),e.whenStable()}).then(function(){setTimeout(function(){var e=n.complete.filter(function(e){return e===t});expect(n.complete.length).toBe(1),expect(e.length).toBe(0)},400)})}))),it("Should add an item correctly, and it should be editable and deletable",r.async(r.inject([],function(){var t=e.componentInstance;e.whenStable().then(function(){return e.detectChanges(),e.whenStable()}).then(function(){return t.addToDo(),e.whenStable()}).then(function(){var n=t.incomplete.filter(function(e){return 1!==e._id.length})[0];return expect(t.incomplete.length).toBe(4),expect(n.editable).toBe(!0),expect(n.editable).toBe(!0),e.whenStable()})}))),it("Should get source bucket correctly",r.async(r.inject([],function(){var t=e.componentInstance;e.whenStable().then(function(){return e.detectChanges(),e.whenStable()}).then(function(){return t.draggingToDo=t.incomplete[0],expect(t.getSource()).toBe("leftBucket"),t.draggingToDo=t.complete[0],expect(t.getSource()).toBe("rightBucket"),e.whenStable()})}))),it("Should move item to incomplete list correctly",r.async(r.inject([],function(){var t=e.componentInstance;e.whenStable().then(function(){return e.detectChanges(),e.whenStable()}).then(function(){var n=t.incomplete[0];return t.draggingToDo=n,t.moveToComplete(),e.whenStable()}).then(function(){return expect(t.incomplete.length).toBe(2),expect(t.complete.length).toBe(3),e.whenStable()})}))),it("Should move item to complete list correctly",r.async(r.inject([],function(){var t=e.componentInstance;e.whenStable().then(function(){return e.detectChanges(),e.whenStable()}).then(function(){var n=t.complete[0];return t.draggingToDo=n,t.moveToIncomplete(),e.whenStable()}).then(function(){return expect(t.incomplete.length).toBe(4),expect(t.complete.length).toBe(1),e.whenStable()})}))),it("Should drop item to incomplete list correctly",r.async(r.inject([],function(){var t=e.componentInstance;e.whenStable().then(function(){return e.detectChanges(),e.whenStable()}).then(function(){t.draggingToDo=t.complete[0];var n={screenX:0,preventDefault:function(){}};return t.onDrop(n),e.whenStable()}).then(function(){return expect(t.incomplete.length).toBe(4),expect(t.complete.length).toBe(1),e.whenStable()})}))),it("Should drop item to complete list correctly",r.async(r.inject([],function(){var t=e.componentInstance;e.whenStable().then(function(){return e.detectChanges(),e.whenStable()}).then(function(){t.draggingToDo=t.incomplete[0];var n={screenX:5e3,preventDefault:function(){}};return t.onDrop(n),e.whenStable()}).then(function(){return expect(t.incomplete.length).toBe(2),expect(t.complete.length).toBe(3),e.whenStable()})})))})}}}),document.addEventListener("DOMContentLoaded",function(){System["import"]("main").then(null,console.error.bind(console))});